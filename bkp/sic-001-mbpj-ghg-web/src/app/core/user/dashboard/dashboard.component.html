<div class="header bg-transparent pb-6">
  <div class="container-fluid">
    <div class="header-body">
      <div class="row align-items-center py-4">
        <div class="col-lg-6 col-7">
          <h6 class="h2 text-dark d-inline-block mb-0">Dashboard</h6>

          <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
              <li class="breadcrumb-item">
                <a> <i class="fas fa-home text-dark"> </i> </a>
              </li>
            </ol>
          </nav>
        </div>
      </div>

      <div class="row align-items-center">
        <div class="col-xl-6 col-md-6">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Application Approved Since 2011
                  </h5>

                  <span class="h2 font-weight-bold mb-0">
                    {{ totalApprovedApplicationsSince2011 }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fas fa-check-double text-indigo"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-6 col-md-6">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Rebate Awarded Since 2011
                  </h5>

                  <span class="h2 font-weight-bold mb-0">
                    RM {{ totalApprovedRebatesSince2011 | number }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fas fa-money-check-alt text-green"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-6 col-md-6">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Application Approved for Current Year
                  </h5>

                  <span class="h2 font-weight-bold mb-0">
                    {{ totalApprovedApplications }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fas fa-check-double text-indigo"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-6 col-md-6">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Rebate Awarded for Current Year
                  </h5>

                  <span class="h2 font-weight-bold mb-0">
                    RM {{ totalApprovedRebates | number }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fas fa-money-check-alt text-green"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-6 col-md-6 ml-auto">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Application Received Since 2011
                  </h5>
                  <span class="h2 font-weight-bold mb-0">
                    {{ totalApplicationsSince2011 }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fas fa-archive text-orange"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-xl-6 col-md-6 mr-auto">
          <div class="card card-stats">
            <div class="card-body">
              <div class="row">
                <div class="col">
                  <h5 class="card-title text-uppercase text-muted mb-0">
                    Total Application Received for Current Year
                  </h5>
                  <span class="h2 font-weight-bold mb-0">
                    {{ totalApplications }}
                  </span>
                </div>

                <div class="col-auto">
                  <div class="icon icon-shape bg-grey rounded-circle shadow">
                    <i class="fab fa-wpforms text-blue"> </i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container-fluid mt--6">
  <div class="row">
    <div class="col-xl-4">
      <div class="card">
        <div class="card-header bg-info py-2">
          <div class="row">
            <div class="col my-auto">
              <h4 class="text-white m-0">Latest Applications</h4>
            </div>
            <div class="col-auto">
              <!--<button type="button" class="btn btn-sm btn-neutral text-info">See all</button>-->
            </div>
          </div>
        </div>
        <div class="card-body">
          <div *ngIf="latestApplications?.length == 0" class="text-center">
            <img
              alt="img"
              src="assets/img/icons/common/error-404-red.svg"
              class="avatar bg-white"
            />
            <p class="mt-2 mb-0">No application found</p>
          </div>
          <div *ngIf="latestApplications?.length != 0" class="text-center">
            <div class="list-group list-group-flush">
              <div
                class="list-group-item"
                *ngFor="let application of latestApplications"
              >
                <div class="row align-items-center">
                  <div class="col-auto">
                    <img
                      alt="img"
                      src="assets/img/icons/common/form.svg"
                      class="avatar bg-white"
                    />
                  </div>
                  <div class="col">
                    <div
                      class="d-flex justify-content-between align-items-center"
                    >
                      <div>
                        <h4 class="mb-0 text-sm"></h4>
                        <span class="badge badge-default mr-2">{{
                          application.date_submitted
                        }}</span>
                      </div>
                      <div class="text-right text-muted">
                        <button
                          type="button"
                          class="btn btn-sm btn-outline-info"
                          (click)="viewApplication(application)"
                        >
                          View
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-4">
      <div class="card">
        <div class="card-header bg-info py-2">
          <div class="row">
            <div class="col my-auto">
              <h4 class="text-white m-0">Latest Applicant Registration</h4>
            </div>
            <div class="col-auto">
              <!--<button type="button" class="btn btn-sm btn-neutral text-info">See all</button>-->
            </div>
          </div>
        </div>
        <div class="card-body">
          <div
            *ngIf="latestRegisteredApplicants?.length == 0"
            class="text-center"
          >
            <img
              alt="img"
              src="assets/img/icons/common/error-404-purple.svg"
              class="avatar bg-white"
            />
            <p class="mt-2 mb-0">No registration found</p>
          </div>
          <div
            *ngIf="latestRegisteredApplicants?.length != 0"
            class="list-group list-group-flush"
          >
            <div
              *ngFor="let applicant of latestRegisteredApplicants"
              class="list-group-item"
            >
              <div class="row align-items-center">
                <div class="col-auto">
                  <img
                    alt="img"
                    src="assets/img/icons/common/checklist.svg"
                    class="avatar bg-white"
                  />
                </div>
                <div class="col">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <h4 class="mb-0 text-sm">{{ applicant.username }}</h4>
                      <span class="badge badge-default mr-2">{{
                        applicant.date_joined
                      }}</span>
                    </div>
                    <div class="text-right text-muted">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-info"
                        (click)="openModal(viewUser, applicant)"
                      >
                        View
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xl-4">
      <div class="card">
        <div class="card-header bg-info py-2">
          <div class="row">
            <div class="col my-auto">
              <h4 class="text-white m-0">Latest Evaluated Applications</h4>
            </div>
            <div class="col-auto">
              <!--<button type="button" class="btn btn-sm btn-neutral text-info">See all</button>-->
            </div>
          </div>
        </div>
        <div class="card-body">
          <div
            *ngIf="latestEvaluatedApplications?.length == 0"
            class="text-center"
          >
            <img
              alt="img"
              src="assets/img/icons/common/error-404-cyan.svg"
              class="avatar bg-white"
            />
            <p class="mt-2 mb-0">No evaluated application found</p>
          </div>
          <div
            *ngIf="latestEvaluatedApplications?.length != 0"
            class="list-group list-group-flush"
          >
            <div
              *ngFor="let application of latestEvaluatedApplications"
              class="list-group-item"
            >
              <div class="row align-items-center">
                <div class="col-auto">
                  <img
                    alt="img"
                    src="assets/img/icons/common/review.svg"
                    class="avatar bg-white"
                  />
                </div>
                <div class="col">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <h4 class="mb-0 text-sm"></h4>
                      <span class="badge badge-primary mr-2">{{
                        application.date_submitted
                      }}</span>
                    </div>
                    <div class="text-right text-muted">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-info"
                        (click)="viewApplication(application)"
                      >
                        View
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header bg-info py-2">
          <div class="row">
            <div class="col my-auto">
              <h4 class="text-white m-0">Average Carbon Emission</h4>
            </div>
            <div class="col-auto"></div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col">
              <div class="form-group">
                <label class="col-auto form-control-label">Select year</label>
                <select
                  class="col-3 mr-3 form-control custom-select"
                  [(ngModel)]="yearAverageCarbonEmission"
                >
                  <option value="">Please select</option>
                  <option
                    *ngFor="let year of year2011tocurrentyear"
                    [value]="year.value"
                  >
                    {{ year.display_name }}
                  </option>
                </select>
                <button
                  class="col-auto btn btn-info"
                  type="button"
                  (click)="findCarbon()"
                >
                  Search
                </button>
              </div>
            </div>
          </div>
          <div id="chartdiv" style="width: 100%; height: 500px"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #viewUser let-c="close" let-d="dismiss">
  <div class="modal-content">
    <div class="modal-header bg-info">
      <h6 class="modal-title" id="modal-title-default">User Approval</h6>
      <button
        type="button"
        class="close"
        data-dismiss="modal"
        aria-label="Close"
        (click)="closeModal()"
      >
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <div class="modal-body">
      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label class="form-control-label">Name</label>
            <input
              class="form-control"
              value="{{ selectedUser?.full_name }}"
              disabled
              type="text"
            />
          </div>
        </div>
        <div class="col-12">
          <div class="form-group">
            <label class="form-control-label">NRIC</label>
            <input
              class="form-control"
              value="{{ selectedUser?.username }}"
              disabled
              type="text"
            />
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-12">
          <div class="form-group">
            <label class="form-control-label">Phone</label>
            <input
              class="form-control"
              value="{{ selectedUser?.phone }}"
              disabled
              type="text"
            />
          </div>
        </div>
        <div class="col-12">
          <div class="form-group">
            <label class="form-control-label">Email</label>
            <input
              class="form-control"
              value="{{ selectedUser?.email }}"
              disabled
              type="text"
            />
          </div>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button
        type="button"
        class="btn btn-link ml-auto"
        data-dismiss="modal"
        (click)="closeModal()"
      >
        Close
      </button>
    </div>
  </div>
</ng-template>
